---
title: "Rapport1"
format: html
editor_options: 
  chunk_output_type: console
---

# Oppgave 1: Reliabilitet og verktøy for å reprodusere data

Hensikten med denne rapporten er å presentere estimater for reliabilitet av data samlet i fysiologisk testlab ved Høgskolen i Innlandet. Vi har gjennomført VO2max tester på sykkel der 16 deltakere har gjennomført 2 eller 4 tester i løpet av tre uker. De to første testene ble gjennomført med ca. 24 timers mellomrom i uke en. De to siste testene ble gjennomført med ca. 48 timers mellomrom i uke tre. Vi har brukt Rstudio for å analysere dataen og få svar på om våre tester er reliable.

**protokoll (+ preparations of the participant)**

**kommentere standardisering av test**

**post-test data preparation**

**figur og tabell**

**reliability**

**konklusjon**

## Elements of the report

**Importantly, the report should contain:**

-   At least one table (created from your data)
-   At least one figure (created from your data), and
-   data presented in the text.
-   The report should use a bibliography file to manage references.

```{r}
#| echo: false
#| warning: false

library(readxl)
library(dplyr)

vars <- c("id", "timepoint", "temperature", "humidity", 
          "sex", "age", "height", "weight", "w.max", 
          "vo2.max", "vco2.max", "rer.max", "ve.max", 
          "bf.max", "hr.max", "la.max", 
          "borg.max")


dat <- bind_rows(
read_excel("g1.xlsx", sheet = "data_excel", na = "na") %>%
  select(all_of(vars)) %>%
  mutate(group = "G1", 
         id = paste0(group, "_", id)) ,

read_excel("g2.xlsx", na = "na") %>%
   select(all_of(vars)) %>%
  mutate(group = "G2", 
         id = paste0(group, "_", id)) ,

read_excel("g3.xlsx") %>%
   select(all_of(vars)) %>%
  mutate(timepoint = paste0("t", timepoint), 
         group = "G3", 
         id = paste0(group, "_", id)) ,

read_excel("g4.xlsx") %>%
   select(all_of(vars)) %>%
  mutate(group = "G4", 
         id = paste0(group, "_", id)) )
  


```

# Figur

```{r}
#| echo: false
#| warning: false

library(ggplot2)
  ggplot(data = dat, aes(x = id , y = vo2.max, color = timepoint)) + geom_point() 
 


```

Tabell

```{r}
#| echo: false
#| warning: false
#| 
library(tidyverse)
dat %>%
  select(id, timepoint, vo2.max) %>%
  pivot_wider(names_from = timepoint,
              values_from = vo2.max) %>%
  print()

```

Calculate typical error between t1 and t2

```{r}
#| echo: false

cv1 <- dat %>%
  select(id, timepoint, vo2.max) %>%
  pivot_wider(names_from = timepoint, 
              values_from = vo2.max) %>%
  
  mutate(diff = t2 - t1) %>% 
  summarise(m = mean(c(t1, t2), na.rm = TRUE), 
            s = sd(diff, na.rm = TRUE),  
            te = s / sqrt(2), 
            cv = 100 * (te/m)) %>%
  print()


cv_percent1 <- round(cv1$cv,1) %>%
  print()

```

Calculate typical error between t3 and t4

```{r}
#| echo: false

cv2 <- dat %>%
  select(id, timepoint, vo2.max) %>%
  pivot_wider(names_from = timepoint, 
              values_from = vo2.max) %>%
  
  mutate(diff = t3 - t4) %>% 
  summarise(m = mean(c(t1, t2), na.rm = TRUE), 
            s = sd(diff, na.rm = TRUE),  
            te = s / sqrt(2), 
            cv = 100 * (te/m)) %>%
  print()


cv_percent2 <- round(cv2$cv,1) %>%
  print()

```
